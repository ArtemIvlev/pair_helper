# ๐ ะะฐัััะพะนะบะฐ nginx ะดะปั Pair Helper

## ะะฑะทะพั ะฐััะธัะตะบัััั

```
ะะฝัะตัะฝะตั โ nginx (HTTPS) โ Docker ะบะพะฝัะตะนะฝะตัั (HTTP)
                โ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ  nginx (ะฒะฝะตัะฝะธะน, ะฟะพัั 443)      โ
    โ  - SSL/TLS ัะตัะผะธะฝะฐัะธั           โ
    โ  - Rate limiting                โ
    โ  - ะะฐะณะพะปะพะฒะบะธ ะฑะตะทะพะฟะฐัะฝะพััะธ       โ
    โโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโ
                      โ
    โโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโ
    โ     Docker ะบะพะฝัะตะนะฝะตัั           โ
    โ  - Frontend (ะฟะพัั 3000)         โ
    โ  - Backend API (ะฟะพัั 8000)      โ
    โ  - Admin (ะฟะพัั 5001)            โ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ ะััััะฐั ะฝะฐัััะพะนะบะฐ

### 1. ะกะบะพะฟะธััะนัะต ะบะพะฝัะธะณััะฐัะธั
```bash
sudo cp docs/nginx-proxy-config.conf /etc/nginx/sites-available/pair-helper
```

### 2. ะะฐัััะพะนัะต SSL ัะตััะธัะธะบะฐัั
ะััะตะดะฐะบัะธััะนัะต ะฒ ะบะพะฝัะธะณััะฐัะธะธ:
```nginx
ssl_certificate /path/to/your/cert.pem;
ssl_private_key /path/to/your/key.pem;
```

### 3. ะะฐัััะพะนัะต IP ะพะณัะฐะฝะธัะตะฝะธั ะดะปั ะฐะดะผะธะฝะบะธ
```nginx
# ะ ัะตะบัะธะธ location /pulse_of_pair/admin/
allow 192.168.1.0/24;  # ะะฐัะฐ ะปะพะบะฐะปัะฝะฐั ัะตัั
allow YOUR_VPN_IP;     # ะะฐั VPN IP
deny all;
```

### 4. ะะบัะธะฒะธััะนัะต ะบะพะฝัะธะณััะฐัะธั
```bash
sudo ln -s /etc/nginx/sites-available/pair-helper /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

## ๐ง ะะฐะถะฝัะต ะฝะฐัััะพะนะบะธ ะฑะตะทะพะฟะฐัะฝะพััะธ

### Rate Limiting
ะะพะฝัะธะณััะฐัะธั ะฒะบะปััะฐะตั ะดะฒััััะพะฒะฝะตะฒัั ะทะฐัะธัั:
- **nginx ััะพะฒะตะฝั**: 10 req/s ะดะปั API, 30 req/s ะดะปั ะฟัะธะปะพะถะตะฝะธั
- **ะัะธะปะพะถะตะฝะธะต**: 100 req/min ะดะพะฟะพะปะฝะธัะตะปัะฝะพ

### ะะฐะณะพะปะพะฒะบะธ ะฑะตะทะพะฟะฐัะฝะพััะธ
- `Strict-Transport-Security` - ะฟัะธะฝัะดะธัะตะปัะฝัะน HTTPS
- `X-Frame-Options: DENY` - ะทะฐัะธัะฐ ะพั clickjacking
- `X-Content-Type-Options: nosniff` - ะทะฐัะธัะฐ ะพั MIME sniffing

### ะัะพะบัะธัะพะฒะฐะฝะธะต
ะะฑัะทะฐัะตะปัะฝัะต ะทะฐะณะพะปะพะฒะบะธ ะดะปั ะบะพััะตะบัะฝะพะน ัะฐะฑะพัั:
```nginx
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;
```

## ๐ ะะพะฝะธัะพัะธะฝะณ

### ะะพะณะธ
```bash
# ะะพัััะฟ
tail -f /var/log/nginx/pair_helper_access.log

# ะัะธะฑะบะธ
tail -f /var/log/nginx/pair_helper_error.log

# Rate limiting
grep "limiting requests" /var/log/nginx/pair_helper_error.log
```

### ะัะพะฒะตัะบะฐ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ
```bash
# ะัะพะฒะตัะบะฐ HTTPS
curl -I https://gallery.homoludens.photos/pulse_of_pair/

# ะัะพะฒะตัะบะฐ API
curl -I https://gallery.homoludens.photos/pulse_of_pair/api/health

# ะัะพะฒะตัะบะฐ ะทะฐะณะพะปะพะฒะบะพะฒ ะฑะตะทะพะฟะฐัะฝะพััะธ
curl -I https://gallery.homoludens.photos/pulse_of_pair/ | grep -E "(Strict-Transport|X-Frame|X-Content)"
```

## โ๏ธ ะะตะทะพะฟะฐัะฝะพััั

### ะะฑัะทะฐัะตะปัะฝะพ ะฝะฐัััะพะนัะต:
1. **SSL ัะตััะธัะธะบะฐัั** (Let's Encrypt ัะตะบะพะผะตะฝะดัะตััั)
2. **IP ะพะณัะฐะฝะธัะตะฝะธั** ะดะปั ะฐะดะผะธะฝะบะธ
3. **Firewall** ะฝะฐ ัะตัะฒะตัะต
4. **ะะตะณัะปััะฝะพะต ะพะฑะฝะพะฒะปะตะฝะธะต** nginx

### ะะตะบะพะผะตะฝะดะฐัะธะธ:
- ะัะฟะพะปัะทัะนัะต ัะพะปัะบะพ TLS 1.2+
- ะะฐัััะพะนัะต ะฐะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต ัะตััะธัะธะบะฐัะพะฒ
- ะะพะฝะธัะพัััะต ะปะพะณะธ ะฝะฐ ะฟะพะดะพะทัะธัะตะปัะฝัั ะฐะบัะธะฒะฝะพััั
- ะะตะณัะปััะฝะพ ะฟัะพะฒะตััะนัะต SSL ะบะพะฝัะธะณััะฐัะธั

## ๐ง ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### ะัะธะปะพะถะตะฝะธะต ะฝะต ะพัะฒะตัะฐะตั
```bash
# ะัะพะฒะตัััะต ััะฐััั ะบะพะฝัะตะนะฝะตัะพะฒ
docker ps

# ะัะพะฒะตัััะต ะปะพะณะธ nginx
sudo tail -f /var/log/nginx/error.log

# ะัะพะฒะตัััะต ะดะพัััะฟะฝะพััั backend
curl -I http://localhost:8000/health
```

### SSL ะฟัะพะฑะปะตะผั
```bash
# ะัะพะฒะตัััะต ัะตััะธัะธะบะฐัั
openssl x509 -in /path/to/cert.pem -text -noout

# ะขะตัั SSL
openssl s_client -connect gallery.homoludens.photos:443
```

### Rate limiting ััะฐะฑะฐััะฒะฐะตั
```bash
# ะะพัะผะพััะธัะต ะฝะฐ rate limiting ะปะพะณะธ
grep "limiting requests" /var/log/nginx/error.log

# ะัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ ัะฒะตะปะธัััะต ะปะธะผะธัั ะฒ ะบะพะฝัะธะณััะฐัะธะธ
```

## ๐ ะะพะดะดะตัะถะบะฐ

ะัะธ ะฟัะพะฑะปะตะผะฐั ะฟัะพะฒะตัััะต:
1. ะกัะฐััั nginx: `systemctl status nginx`
2. ะะพะฝัะธะณััะฐัะธั: `nginx -t`
3. ะะพะณะธ: `/var/log/nginx/`
4. ะกัะฐััั ะบะพะฝัะตะนะฝะตัะพะฒ: `docker ps`
5. ะะพัััะฟะฝะพััั ะฟะพััะพะฒ: `netstat -tlnp | grep -E "(3000|8000|5001)"`

